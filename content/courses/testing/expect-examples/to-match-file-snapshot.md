---
title: toMatchFileSnapshot in Vitest
description: Learn how to match file snapshots in Vitest for regression testing.
modified: 2024-09-28T12:54:13-06:00
---

Let’s talk **`toMatchFileSnapshot`**. This bad boy is a **snapshot matcher** in Vitest (and also exists in other testing frameworks like Jest). You use it when you want to make sure that the output of your code matches a **previously saved snapshot** of its file content. It's super useful for testing bigger chunks of output, like autogenerated files, large configs, or HTML structures.

Think of it like this: you take a snapshot (which gets saved to a file), and each time the test runs, it checks if the current output still matches the stored snapshot. If they don’t match, Vitest tells you, “Hey, something’s different. You sure you meant to change that?”

When would you use it? Well, instead of manually comparing massive output strings, this will automatically take care of that comparison for you in future runs. For example, if your music library app generates JSON files for each band’s details, you can use `toMatchFileSnapshot` to keep track of any changes to those files over time.

## Example Time

Here’s a scenario where you have a simple JSON object for **Green Day** that represents an artist’s profile. When we save this to a file, we want our test to ensure that its contents don’t change unexpectedly, unless we want them to:

```js
import { expect, test } from 'vitest';
import { promises as fs } from 'fs';
import { resolve } from 'path';

test('artist profile matches snapshot', async () => {
	const artistProfile = {
		name: 'Green Day',
		genre: 'Punk Rock',
		albums: ['Dookie', 'American Idiot', 'Nimrod'],
	};

	const filePath = resolve('artist-profile.json');

	// Write it to a file (hypothetically done elsewhere in the app)
	await fs.writeFile(filePath, JSON.stringify(artistProfile, null, 2));

	// Now, check if the file we just wrote matches the saved snapshot
	expect(filePath).toMatchFileSnapshot();
});
```

Here’s what happens:

1. The first time you run the test, Vitest creates a **snapshot** from the `artist-profile.json`.
2. Any subsequent runs compare the current content of this file to the **snapshot**.
3. If there’s a difference (let’s say someone added another album or misspelled "Nimrod" 😱), the test will fail, alerting you that the file has diverged from the expected snapshot.

This is great for **regression** testing when you want to lock down the structure and content of certain outputs (like files!) and ensure that changes only happen when you intend them.

So next time you’re testing randomly generated files, big ol’ JSON objects, templates, or… anything where exactness matters, give `toMatchFileSnapshot` a go!
